<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="애플의 AVFoundation Programming Guide와 Media Playback Programming Guide을 통해 AVFoundation에 대해 알아보았다. AVFoundation?AVFoundation은 시간 기반 시청각 미디어 자료를 플레이하고 생성할 수 있는 프레임워크 중 하나이다. 이 프레임워크를 통해 미디어 파일을 조사하고 조작하는">
<meta name="keywords" content="AVFoundation,AVAsset,Media">
<meta property="og:type" content="article">
<meta property="og:title" content="AVFoundation 공부">
<meta property="og:url" content="https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/index.html">
<meta property="og:site_name" content="PacaLog">
<meta property="og:description" content="애플의 AVFoundation Programming Guide와 Media Playback Programming Guide을 통해 AVFoundation에 대해 알아보았다. AVFoundation?AVFoundation은 시간 기반 시청각 미디어 자료를 플레이하고 생성할 수 있는 프레임워크 중 하나이다. 이 프레임워크를 통해 미디어 파일을 조사하고 조작하는">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/AVFoundationIniOS.png">
<meta property="og:image" content="https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/primaryPlaybackObjects.png">
<meta property="og:updated_time" content="2018-06-10T12:07:33.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="AVFoundation 공부">
<meta name="twitter:description" content="애플의 AVFoundation Programming Guide와 Media Playback Programming Guide을 통해 AVFoundation에 대해 알아보았다. AVFoundation?AVFoundation은 시간 기반 시청각 미디어 자료를 플레이하고 생성할 수 있는 프레임워크 중 하나이다. 이 프레임워크를 통해 미디어 파일을 조사하고 조작하는">
<meta name="twitter:image" content="https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/AVFoundationIniOS.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>AVFoundation 공부</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Posts</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/05/09/closurecaturevalue/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/05/01/kvoprogrammingguide/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/&text=AVFoundation 공부"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/&title=AVFoundation 공부"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/&is_video=false&description=AVFoundation 공부"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=AVFoundation 공부&body=Check out this article: https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/&title=AVFoundation 공부"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/&title=AVFoundation 공부"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/&title=AVFoundation 공부"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/&title=AVFoundation 공부"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/&name=AVFoundation 공부&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#AVFoundation"><span class="toc-number">1.</span> <span class="toc-text">AVFoundation?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Understanding-the-Asset-Model"><span class="toc-number">1.1.</span> <span class="toc-text">Understanding the Asset Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Creating-an-Asset"><span class="toc-number">1.2.</span> <span class="toc-text">Creating an Asset</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Preparing-Assets-for-Use"><span class="toc-number">1.3.</span> <span class="toc-text">Preparing Assets for Use</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Working-with-Metadata"><span class="toc-number">2.</span> <span class="toc-text">Working with Metadata</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Retrieving-a-Collection-of-Metadata"><span class="toc-number">2.1.</span> <span class="toc-text">Retrieving a Collection of Metadata</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Finding-and-Using-Metadata-Values"><span class="toc-number">2.2.</span> <span class="toc-text">Finding and Using Metadata Values</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Playing-Media"><span class="toc-number">3.</span> <span class="toc-text">Playing Media</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AVPlayer"><span class="toc-number">3.1.</span> <span class="toc-text">AVPlayer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AVPlayerItem"><span class="toc-number">3.2.</span> <span class="toc-text">AVPlayerItem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AVKit-and-AVPlayerLayer"><span class="toc-number">3.3.</span> <span class="toc-text">AVKit and AVPlayerLayer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Observing-Playback-State"><span class="toc-number">4.</span> <span class="toc-text">Observing Playback State</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Performing-Time-Based-Operations"><span class="toc-number">5.</span> <span class="toc-text">Performing Time-Based Operations</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Observing-Time"><span class="toc-number">5.1.</span> <span class="toc-text">Observing Time</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Periodic-Observations"><span class="toc-number">5.1.1.</span> <span class="toc-text">Periodic Observations</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Boundary-Observations"><span class="toc-number">5.1.2.</span> <span class="toc-text">Boundary Observations</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Seeking-Media"><span class="toc-number">5.2.</span> <span class="toc-text">Seeking Media</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">6.</span> <span class="toc-text">Reference</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        AVFoundation 공부
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">PacaLog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-05-03T06:32:24.000Z" itemprop="datePublished">2018-05-03</time>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/AVAsset/">AVAsset</a>, <a class="tag-link" href="/tags/AVFoundation/">AVFoundation</a>, <a class="tag-link" href="/tags/Media/">Media</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>애플의 <a href="https://developer.apple.com/library/content/documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/00_Introduction.html#//apple_ref/doc/uid/TP40010188-CH1-SW3" target="_blank" rel="noopener">AVFoundation Programming Guide</a>와 <a href="https://developer.apple.com/library/content/documentation/AudioVideo/Conceptual/MediaPlaybackGuide/Contents/Resources/en.lproj/ExploringAVFoundation/ExploringAVFoundation.html#//apple_ref/doc/uid/TP40016757-CH4-SW1" target="_blank" rel="noopener">Media Playback Programming Guide</a>을 통해 AVFoundation에 대해 알아보았다.</p>
<h2 id="AVFoundation"><a href="#AVFoundation" class="headerlink" title="AVFoundation?"></a>AVFoundation?</h2><p>AVFoundation은 시간 기반 시청각 미디어 자료를 플레이하고 생성할 수 있는 프레임워크 중 하나이다. 이 프레임워크를 통해 미디어 파일을 조사하고 조작하는 것이 가능하다.</p>
<img src="/2018/05/03/avfoundationprogrammingguide/AVFoundationIniOS.png" title="image">
<p>AVFoudation에서 미디어 자료를 표현하는 가장 대표적인 타입인 AVAsset부터 보자.</p>
<h3 id="Understanding-the-Asset-Model"><a href="#Understanding-the-Asset-Model" class="headerlink" title="Understanding the Asset Model"></a>Understanding the Asset Model</h3><p>AVFoudation에서 가장 중요한 타입은 <em>AVAsset</em>이다. AVAsset은 오디오와 비디오 트랙, 제목, 길이, 자연스러운 영상 사이즈 등 다양한 데이터의 집합체이다. 또한 대부분의 미디어 파일 포맷을 지원하고 HTTP Live Streaming(HLS)도 지원한다. 이를 통해 개발자로 하여금 미디어 포맷으로부터의 독립성과 미디어 자료의 위치에 대한 독립성을 주어 좀 더 개발에 집중할 수 있도록 한다.</p>
<p>AVAsset은 <code>AVAssetTrack</code> 타입의 다양한 트랙이 모여 만들어진다. 즉, 비디오 트랙과 오디오 트랙, 자막 트랙 등으로 나뉘어지고 이것이 합쳐져 하나의 AVAsset을 이루는 구조이다.</p>
<h3 id="Creating-an-Asset"><a href="#Creating-an-Asset" class="headerlink" title="Creating an Asset"></a>Creating an Asset</h3><p>AVAsset은 추상적인 클래스로 초기화 시에는 url을 사용해 AVAsset의 인스턴스가 아닌 AVURLAsset 타입의 인스턴스가 생성된다. init 메서드는 다음과 같다.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">init</span>(url <span class="type">URL</span>: <span class="type">URL</span>, options: [<span class="type">String</span> : <span class="type">Any</span>]? = <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure></p>
<p>이 때 전달하는 options 인자에는 다음과 같은 key와 value가 들어간다.</p>
<ul>
<li><code>AVURLAssetPreferPreciseDurationAndTimingKey</code>: NSNumber로 감싸진 boolean 값을 value로 가지며 asset이 준비될 때 정확한 duration과 시간으로 random access가 가능하게끔 하는 여부를 판단한다. 기본값은 false지만 만약 true로 하는 경우 asset을 준비하는 데에 보통의 경우보다 좀 더 시간이 걸리기 때문에 asset을 조작하거나 하는 경우에만 사용하는 것이 좋다.</li>
<li><code>AVURLAssetReferenceRestrictionsKey</code>: NSNumber로 래핑된 <code>AVAssetReferenceRestrictions</code>의 열거형 값을 value로 가지며 이 값들을 조합해 외부의 미디어 데이터를 사용하는 것에 제한을 둔다.</li>
<li><code>AVURLAssetHTTPCookiesKey</code>: HTTP 리퀘스트 시 보내는 쿠키를 값으로 가진다.</li>
<li><code>AVURLAssetAllowsCellularAccessKey</code>: 미디어 자료를 볼 때 셀룰러 네트워크를 사용할 것인가를 boolean 값으로 가지는 key로 기본값은 true이다.</li>
</ul>
<h3 id="Preparing-Assets-for-Use"><a href="#Preparing-Assets-for-Use" class="headerlink" title="Preparing Assets for Use"></a>Preparing Assets for Use</h3><p>AVAsset는 지금 재생이 가능한지 여부, 총 길이, 생성 날짜 등 다양한 정보들을 담고 있다. 이러한 정보들은 플레이어를 만들 때 유용하게 쓰일 것이다. 그런데 이러한 프로퍼티들은 AVAsset이 생성될 때 자동으로 같이 나오지 않고 요청이 오면 그제서야 불러오기 시작한다. <strong>원활한 UI 작업을 위해 요청은 비동기적으로 처리</strong>하라.</p>
<p>AVAsset과 AVAssetTrack은 <code>AVAsynchronousKeyValueLoading</code> 프로토콜을 준수하며 이를 여기에 정의된 두 메서드로 프로퍼티가 사용 가능 여부 확인과 불러오기 요청을 할 수 있다.</p>
<ul>
<li><code>loadValuesAsynchronously(forKeys:completionHandler:)</code>: AVAsset의 인스턴스에 key의 배열에 전달된 값에 해당하는 프로퍼티들을 비동기적으로 요청하는 메서드이다. 필요한 프로퍼티들을 불러와 사용이 가능할 때의 처리를 해주면 된다.</li>
<li><code>statusOfValue(forKey:error:)</code>: key에 해당하는 프로퍼티가 즉시 사용 가능한지 여부를 확인하는 메서드로 호출하는 스레드를 블록하지 않는다.</li>
</ul>
<p>다음은 애플의 예제 코드이다.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// URL of a bundle asset called 'example.mp4'</span></span><br><span class="line"><span class="keyword">let</span> url = <span class="type">Bundle</span>.main.url(forResource: <span class="string">"example"</span>, withExtension: <span class="string">"mp4"</span>)!</span><br><span class="line"><span class="keyword">let</span> asset = <span class="type">AVAsset</span>(url: url)</span><br><span class="line"><span class="keyword">let</span> playableKey = <span class="string">"playable"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Load the "playable" property</span></span><br><span class="line">asset.loadValuesAsynchronously(forKeys: [playableKey]) &#123;</span><br><span class="line">    <span class="keyword">var</span> error: <span class="type">NSError</span>? = <span class="literal">nil</span></span><br><span class="line">    <span class="keyword">let</span> status = asset.statusOfValue(forKey: playableKey, error: &amp;error)</span><br><span class="line">    <span class="keyword">switch</span> status &#123;</span><br><span class="line">    <span class="keyword">case</span> .loaded:</span><br><span class="line">        <span class="comment">// Sucessfully loaded. Continue processing.</span></span><br><span class="line">    <span class="keyword">case</span> .failed:</span><br><span class="line">        <span class="comment">// Handle error</span></span><br><span class="line">    <span class="keyword">case</span> .cancelled:</span><br><span class="line">        <span class="comment">// Terminate processing</span></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="comment">// Handle all other cases</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="Working-with-Metadata"><a href="#Working-with-Metadata" class="headerlink" title="Working with Metadata"></a>Working with Metadata</h2><p>미디어 자료는 각각 메타데이터(metadata)를 담고 있다. 미디어의 포맷에 따라 메타데이터의 종류가 달라지기 때문에 iOS에서는 <code>AVMetadataItem</code>이라는 클래스를 제공해 메타 데이터를 다루는 데 용이하도록 하였다. AVMetadataItem의 인스턴스는 키-값의 쌍으로 존재한다.</p>
<h3 id="Retrieving-a-Collection-of-Metadata"><a href="#Retrieving-a-Collection-of-Metadata" class="headerlink" title="Retrieving a Collection of Metadata"></a>Retrieving a Collection of Metadata</h3><p>AVFoundation에서는 메타데이터를 보다 쉽게 찾고 구별할 수 있도록 두 개의 그룹으로 메타데이터의 키를 구분한다.</p>
<ul>
<li>Format-specific key spaces: 미디어 자료의 포맷만의 메타데이터의 키를 의미하며 <code>metadata</code> 프로퍼티를 사용해 접근할 수 있다.</li>
<li>Common key space: 미디어 자료의 포맷에 국한되지 않는 메타데이터의 키들을 의미하며 예로는 생성일, 설명 등이 있다. <code>commonMetadata</code> 프로퍼티로 접근이 가능하다.</li>
</ul>
<p>asset이 어떤 메타데이터를 포함하고 있는지를 알아보려면 <code>availableMetadataFormats</code> 프로퍼티를 비동기적으로 불러와서 사용한다. 이 프로퍼티로 접근하면 포함하고 있는 메타데이터들의 문자열로 된 식별자들의 배열이 반환된다.</p>
<p>다음은 애플의 예제 코드이다.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> url = <span class="type">Bundle</span>.main.url(forResource: <span class="string">"audio"</span>, withExtension: <span class="string">"m4a"</span>)!</span><br><span class="line"><span class="keyword">let</span> asset = <span class="type">AVAsset</span>(url: url)</span><br><span class="line"><span class="keyword">let</span> formatsKey = <span class="string">"availableMetadataFormats"</span></span><br><span class="line">asset.loadValuesAsynchronously(forKeys: [formatsKey]) &#123;</span><br><span class="line">    <span class="keyword">var</span> error: <span class="type">NSError</span>? = <span class="literal">nil</span></span><br><span class="line">    <span class="keyword">let</span> status = asset.statusOfValue(forKey: formatsKey, error: &amp;error)</span><br><span class="line">    <span class="keyword">if</span> status == .loaded &#123;</span><br><span class="line">        <span class="keyword">for</span> format <span class="keyword">in</span> asset.availableMetadataFormats &#123;</span><br><span class="line">            <span class="keyword">let</span> metadata = asset.metadata(forFormat: format)</span><br><span class="line">            <span class="comment">// process format-specific metadata collection</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Finding-and-Using-Metadata-Values"><a href="#Finding-and-Using-Metadata-Values" class="headerlink" title="Finding and Using Metadata Values"></a>Finding and Using Metadata Values</h3><p>메타데이터의 컬렉션을 얻었다면 개별 메타데이터에 접근할 차례이다. AVMetadataItem 클래스의 클래스 메서드를 사용해서 메타데이터 별로 구분해서 얻어올 수 있는데 그 중 가장 쉬운 방법은 식별자를 사용해서 얻어오는 것이다.</p>
<p>다음은 애플의 예제 코드이다.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> metadata = asset.commonMetadata</span><br><span class="line"><span class="keyword">let</span> titleID = commonIdentifierTitle <span class="comment">// Objective-C에서는 AVMetadataCommonIdentifierTitle</span></span><br><span class="line"><span class="keyword">let</span> titleItems = <span class="type">AVMetadataItem</span>.metadataItems(from: metadata, filteredByIdentifier: titleID)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> item = titleItems.first &#123;</span><br><span class="line">    <span class="comment">// process title item</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>AVMetadataItem의 필터링 메서드들은 하나의 메타데이터가 아니라 컬렉션 타입을 반환한다. 대부분의 경우 컬렉션 안에 하나의 메타데이터가 들어 있지만 로컬라이즈되거나 공통 키공간에서 데이타를 받고 여러 키공간에서 같은 값을 가지고 있는 경우 여러 데이타가 반환될 수 있다.</p>
</blockquote>
<p>메타데이터를 받은 다음에는 그 안에 들어있는 실제적 데이터를 <code>value</code> 프로퍼티를 통해 받아온다. 반환되는 값은 NSObject를 상속하고 NSCopying 프로토콜을 준수하는 데 이를 타입 캐스팅하여 사용할 때는 <code>stringValue</code>, <code>numberValue</code>, <code>dateValue</code>, <code>dataValue</code> 프로퍼티를 사용해 안전하고 쉽게 변환하는 것이 권장된다.</p>
<p>다음은 애플의 예제 코드이다.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Collection of "common" metadata</span></span><br><span class="line"><span class="keyword">let</span> metadata = asset.commonMetadata</span><br><span class="line"><span class="comment">// Filter metadata to find the asset's artwork</span></span><br><span class="line"><span class="keyword">let</span> artworkItems =</span><br><span class="line">    <span class="type">AVMetadataItem</span>.metadataItems(from: metadata,</span><br><span class="line">                                 filteredByIdentifier: commonIdentifierArtwork)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> artworkItem = artworkItems.first &#123;</span><br><span class="line">    <span class="comment">// Coerce the value to an NSData using its dataValue property</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> imageData = artworkItem.dataValue &#123;</span><br><span class="line">        <span class="keyword">let</span> image = <span class="type">UIImage</span>(data: imageData)</span><br><span class="line">        <span class="comment">// process image</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// No image data found</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="Playing-Media"><a href="#Playing-Media" class="headerlink" title="Playing Media"></a>Playing Media</h2><p>AVAsset이 미디어 자료를 표현하는 중요한 클래스지만 미디어를 재생하는 데에 추가적인 클래스들이 이용된다.</p>
<img src="/2018/05/03/avfoundationprogrammingguide/primaryPlaybackObjects.png" title="image">
<h3 id="AVPlayer"><a href="#AVPlayer" class="headerlink" title="AVPlayer"></a>AVPlayer</h3><p><code>AVPlayer</code>는 미디어 에셋을 재생하고 시간을 조절하는 중심 컨트롤러 클래스이다. 로컬로, 다운로드하면서 또는 스트리밍 데이터를 재생하는 데 모두 사용된다.</p>
<blockquote>
<p>AVPlayer는 하나의 미디어 자료를 재생하는 클래스이다. 연속적으로 미디어를 재생하려면 AVPlayer를 상속하는 <code>AVQueuePlayer</code>를 사용하면 된다.</p>
</blockquote>
<h3 id="AVPlayerItem"><a href="#AVPlayerItem" class="headerlink" title="AVPlayerItem"></a>AVPlayerItem</h3><p>AVAsset은 미디어의 정적인 측면을 모델링하기 때문에 AVPlayer의 재생에는 맞지 않는다. 대신 동적인 성격을 갖고 있는 <code>AVPlayerItem</code>의 인스턴스를 대신 사용한다. 이 클래스는 AVPlayer에 의해 재생되는 asset의 재생 상태를 표현한다. AVPlayerItem의 프로퍼티와 메서드를 사용해 미디어의 특정 시간대로 가거나 화면 크기, 현재 시간 등을 알 수 있다.</p>
<h3 id="AVKit-and-AVPlayerLayer"><a href="#AVKit-and-AVPlayerLayer" class="headerlink" title="AVKit and AVPlayerLayer"></a>AVKit and AVPlayerLayer</h3><p>AVPlayer와 AVPlayerItem은 눈에 보이는 객체들이 아니기 때문에 이것을 스크린에 띄워줄 클래스가 필요하다. 두 가지 옵션이 있다.</p>
<ul>
<li><code>AVKit</code>: 비디오 컨텐츠를 보여주는 가장 좋은 방법은 AVKit 프레임워크 안의 <code>AVPlayerViewController</code>이다. 이 객체는 재생 관련 메서드들을 이미 가지고 있다.</li>
<li><code>AVPlayerLayer</code>: 만약 <strong>커스텀 플레이어를 만들고 싶다면 <code>CALayer</code>를 상속하는 AVFoundation의 AVPlayerLayer를 사용</strong>해야 한다. 이 레이어를 뷰의 하위 레이어로 정하거나 레이어 계층에 포함시켜 비디오 컨텐트를 보이게 한다. 그러나 <strong>AVPlayerLayer에는 보여주는 기능밖에 없기 때문에 다른 재생 관련 제어는 개발자가 직접 구현</strong>해야 한다.</li>
</ul>
<h2 id="Observing-Playback-State"><a href="#Observing-Playback-State" class="headerlink" title="Observing Playback State"></a>Observing Playback State</h2><p>AVPlayer와 AVPlayerItem은 상태가 계속 변하는 동적인 객체들이다. 당신은 이 상태의 변화에 따라 반응하고 그에 따른 처리를 하고 싶은 경우가 많을 것이다. 이 때 사용되는 것이 Key-Value Observing(KVO)이다. KVO를 통해 AVPlayer와 AVPlayerItem의 상태의 변화를 추적하고 그에 따른 처리를 해주면 된다.</p>
<p>AVPlayerItem의 프로퍼티 중 가장 많이 감지하는 것들 중 하나가 <code>status</code>이다. 이 프로퍼티는 AVPlayerItem의 재생 가능 여부를 알아볼 때 가장 많이 사용된다.</p>
<p>다음은 애플의 예제 코드이다.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> url: <span class="type">URL</span> = <span class="comment">// Asset URL</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> asset: <span class="type">AVAsset</span>!</span><br><span class="line"><span class="keyword">var</span> player: <span class="type">AVPlayer</span>!</span><br><span class="line"><span class="keyword">var</span> playerItem: <span class="type">AVPlayerItem</span>!</span><br><span class="line"> </span><br><span class="line"><span class="comment">// Key-value observing context</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">var</span> playerItemContext = <span class="number">0</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> requiredAssetKeys = [</span><br><span class="line">    <span class="string">"playable"</span>,</span><br><span class="line">    <span class="string">"hasProtectedContent"</span></span><br><span class="line">]</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">prepareToPlay</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// Create the asset to play</span></span><br><span class="line">    asset = <span class="type">AVAsset</span>(url: url)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Create a new AVPlayerItem with the asset and an</span></span><br><span class="line">    <span class="comment">// array of asset keys to be automatically loaded</span></span><br><span class="line">    playerItem = <span class="type">AVPlayerItem</span>(asset: asset,</span><br><span class="line">                              automaticallyLoadedAssetKeys: requiredAssetKeys)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Register as an observer of the player item's status property</span></span><br><span class="line">    playerItem.addObserver(<span class="keyword">self</span>,</span><br><span class="line">                           forKeyPath: #keyPath(<span class="type">AVPlayerItem</span>.status),</span><br><span class="line">                           options: [.old, .new],</span><br><span class="line">                           context: &amp;playerItemContext)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Associate the player item with the player</span></span><br><span class="line">    player = <span class="type">AVPlayer</span>(playerItem: playerItem)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>이렇게 등록한 옵저버는 playerItem의 상태 변화가 일어나면 메시지를 보내주는 데 이를 <code>observeValueForKeyPath:ofObject:change:context:</code>를 사용해서 받는다.</p>
<p>다음은 애플의 예제 코드이다.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">observeValue</span><span class="params">(forKeyPath keyPath: String?,</span></span></span><br><span class="line"><span class="function"><span class="params">                           of object: Any?,</span></span></span><br><span class="line"><span class="function"><span class="params">                           change: [NSKeyValueChangeKey : Any]?,</span></span></span><br><span class="line"><span class="function"><span class="params">                           context: UnsafeMutableRawPointer?)</span></span> &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// Only handle observations for the playerItemContext</span></span><br><span class="line">    <span class="keyword">guard</span> context == &amp;playerItemContext <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.observeValue(forKeyPath: keyPath,</span><br><span class="line">                           of: object,</span><br><span class="line">                           change: change,</span><br><span class="line">                           context: context)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> keyPath == #keyPath(<span class="type">AVPlayerItem</span>.status) &#123;</span><br><span class="line">        <span class="keyword">let</span> status: <span class="type">AVPlayerItemStatus</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> statusNumber = change?[.newKey] <span class="keyword">as</span>? <span class="type">NSNumber</span> &#123;</span><br><span class="line">            status = <span class="type">AVPlayerItemStatus</span>(rawValue: statusNumber.intValue)!</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            status = .unknown</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Switch over status value</span></span><br><span class="line">        <span class="keyword">switch</span> status &#123;</span><br><span class="line">        <span class="keyword">case</span> .readyToPlay:</span><br><span class="line">            <span class="comment">// Player item is ready to play.</span></span><br><span class="line">        <span class="keyword">case</span> .failed:</span><br><span class="line">            <span class="comment">// Player item failed. See error.</span></span><br><span class="line">        <span class="keyword">case</span> .unknown:</span><br><span class="line">            <span class="comment">// Player item is not yet ready.</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="Performing-Time-Based-Operations"><a href="#Performing-Time-Based-Operations" class="headerlink" title="Performing Time-Based Operations"></a>Performing Time-Based Operations</h2><p>미디어 재생은 시간 기반 활동이다. AVPlayer나 AVPlayerItem의 많은 핵심 기능들도 미디어의 타이밍을 제어하는 것과 관련이 있다. 이러한 기능을 효과적으로 다루기 위해서는 AVFoundation에서 시간을 어떻게 표현하는지에 대해 알아야 하는데 이것이 바로 <code>CMTime</code>이다.</p>
<p>CMTime은 Core Media 프레임워크의 데이타 타입으로 시간을 부분으로 쪼개서 표현한다.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">CMTime</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> value: <span class="type">CMTimeValue</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> timescale: <span class="type">CMTimeScale</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> flags: <span class="type">CMTimeFlags</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> epoch: <span class="type">CMTimeEpoch</span></span><br><span class="line">&#125;</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line"><span class="type">CMTime</span>의 가장 중요한 두 프로퍼티는 value와 timescale이다. `<span class="type">CMTimeValue</span>`는 <span class="number">64</span>비트 integer 값의 시간의 분자값이고 `<span class="type">CMTimeScale</span>`은 <span class="number">32</span>비트 integer 값의 시간의 분모값이다. 이 두개가 이루어져 시간을 표현한다.</span><br><span class="line"></span><br><span class="line">``` <span class="type">Swift</span></span><br><span class="line"><span class="comment">// 0.25 seconds</span></span><br><span class="line"><span class="keyword">let</span> quarterSecond = <span class="type">CMTime</span>(value: <span class="number">1</span>, timescale: <span class="number">4</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 10 second mark in a 44.1 kHz audio file</span></span><br><span class="line"><span class="keyword">let</span> tenSeconds = <span class="type">CMTime</span>(value: <span class="number">441000</span>, timescale: <span class="number">44100</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 3 seconds into a 30fps video</span></span><br><span class="line"><span class="keyword">let</span> cursor = <span class="type">CMTime</span>(value: <span class="number">90</span>, timescale: <span class="number">30</span>)</span><br></pre></td></tr></table></figure>
<p>Core Media 프레임워크에서는 CMTime 간 산술, 비교, 증명, 변환 연산을 지원한다.</p>
<h3 id="Observing-Time"><a href="#Observing-Time" class="headerlink" title="Observing Time"></a>Observing Time</h3><p>일반적으로 미디어 플레이어는 재생 시간을 감지해 재생의 진행 정도를 캐치해 UI에 적용한다. 앞서 상태를 감지하는 KVO 기법은 시간의 연속적인 변화에 따른 상태 변화를 감지하는 데에는 바르지 않은 선택이다. 대신 AVPlayer는 두 가지 방법을 제공한다.</p>
<h4 id="Periodic-Observations"><a href="#Periodic-Observations" class="headerlink" title="Periodic Observations"></a>Periodic Observations</h4><p>일정 시간 간격으로 시간을 감지하는 방법으로 일반적으로 커스텀 플레이어를 만들 때 현재 시간을 업데이트하는 용도로 사용된다.</p>
<p><code>addPeriodicTimeObserverForInterval:queue:usingBlock:</code> 메서드를 통해 감지하며 인자로 감지할 시간 간격, serial한 디스패치 큐, 그리고 감지한 CMTime을 인자로 갖는 콜백 블럭을 전달한다.</p>
<p>다음은 애플의 예제 코드이다.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> player: <span class="type">AVPlayer</span>!</span><br><span class="line"><span class="keyword">var</span> playerItem: <span class="type">AVPlayerItem</span>!</span><br><span class="line"><span class="keyword">var</span> timeObserverToken: <span class="type">Any</span>?</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addPeriodicTimeObserver</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// Notify every half second</span></span><br><span class="line">    <span class="keyword">let</span> timeScale = <span class="type">CMTimeScale</span>(<span class="type">NSEC_PER_SEC</span>)</span><br><span class="line">    <span class="keyword">let</span> time = <span class="type">CMTime</span>(seconds: <span class="number">0.5</span>, preferredTimescale: timeScale)</span><br><span class="line">    timeObserverToken = player.addPeriodicTimeObserver(forInterval: time,</span><br><span class="line">                                                       queue: .main) &#123;</span><br><span class="line">        [<span class="keyword">weak</span> <span class="keyword">self</span>] time <span class="keyword">in</span></span><br><span class="line">        <span class="comment">// update player transport UI</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">removePeriodicTimeObserver</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> timeObserverToken = timeObserverToken &#123;</span><br><span class="line">        player.removeTimeObserver(timeObserverToken)</span><br><span class="line">        <span class="keyword">self</span>.timeObserverToken = <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="Boundary-Observations"><a href="#Boundary-Observations" class="headerlink" title="Boundary Observations"></a>Boundary Observations</h4><p>이 방법은 정해진 시간 구간 내에서 옵저버를 달아두는 것으로 위의 방법보다는 덜 사용하는 방법이다. <code>addBoundaryTimeObserverForTimes:queue:usingBlock:</code> 메서드를 통해 이루어지며 인자로 시간 구간을 전달한다.</p>
<h3 id="Seeking-Media"><a href="#Seeking-Media" class="headerlink" title="Seeking Media"></a>Seeking Media</h3><p>미디어의 현재 시간을 원하는 위치로 이동시키는 것으로 AVKit에서는 기본 제공되는 기능이다. 그러나 커스텀으로 플레이어를 만들 경우 직접 구현해주어야 한다.</p>
<p>AVPlayer와 AVPlayerItem에 이를 가능하게 하는 메서드들이 있지만 가장 일반적인 방법은 <code>seek(to:)</code> 메서드를 사용하는 것이다. 플레이어의 시간을 인자로 전달된 CMTime으로 바꾸는 것이다.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Seek to the 2 minute mark</span></span><br><span class="line"><span class="keyword">let</span> time = <span class="type">CMTime</span>(value: <span class="number">120</span>, timescale: <span class="number">1</span>)</span><br><span class="line">player.seek(to: time)</span><br></pre></td></tr></table></figure>
<p><code>seek(to:)</code> 메서드는 정확성보다 빠르게 이동시키는 속도에 초점이 맞춰져 있기 때문에 정확성이 떨어질 수 있다. 즉, 목표 시간과 오차가 있는 시간으로 이동할 수 있다는 뜻이다. 만약 좀 더 정확한 타이밍으로 가려면 <code>seekToTime:toleranceBefore:toleranceAfter:</code> 메서드를 사용해 목표 시간의 전후에 얼마나 오차를 허용할 지를 전달하면 된다.</p>
<blockquote>
<p><code>seekToTime:toleranceBefore:toleranceAfter:</code> 메서드의 오차 허용값으로 작거나 0의 값을 전달할 경우 타이밍을 찾는 것이 딜레이를 일으킬 수 있다.</p>
</blockquote>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="https://developer.apple.com/library/content/documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/00_Introduction.html#//apple_ref/doc/uid/TP40010188-CH1-SW3" target="_blank" rel="noopener">AVFoundation Programming Guide - Apple Developer Documentation</a></li>
<li><a href="https://developer.apple.com/library/content/documentation/AudioVideo/Conceptual/MediaPlaybackGuide/Contents/Resources/en.lproj/ExploringAVFoundation/ExploringAVFoundation.html#//apple_ref/doc/uid/TP40016757-CH4-SW1" target="_blank" rel="noopener">Media Playback Programming Guide - Apple Developer Documentation</a></li>
</ul>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Posts</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#AVFoundation"><span class="toc-number">1.</span> <span class="toc-text">AVFoundation?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Understanding-the-Asset-Model"><span class="toc-number">1.1.</span> <span class="toc-text">Understanding the Asset Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Creating-an-Asset"><span class="toc-number">1.2.</span> <span class="toc-text">Creating an Asset</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Preparing-Assets-for-Use"><span class="toc-number">1.3.</span> <span class="toc-text">Preparing Assets for Use</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Working-with-Metadata"><span class="toc-number">2.</span> <span class="toc-text">Working with Metadata</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Retrieving-a-Collection-of-Metadata"><span class="toc-number">2.1.</span> <span class="toc-text">Retrieving a Collection of Metadata</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Finding-and-Using-Metadata-Values"><span class="toc-number">2.2.</span> <span class="toc-text">Finding and Using Metadata Values</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Playing-Media"><span class="toc-number">3.</span> <span class="toc-text">Playing Media</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AVPlayer"><span class="toc-number">3.1.</span> <span class="toc-text">AVPlayer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AVPlayerItem"><span class="toc-number">3.2.</span> <span class="toc-text">AVPlayerItem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AVKit-and-AVPlayerLayer"><span class="toc-number">3.3.</span> <span class="toc-text">AVKit and AVPlayerLayer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Observing-Playback-State"><span class="toc-number">4.</span> <span class="toc-text">Observing Playback State</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Performing-Time-Based-Operations"><span class="toc-number">5.</span> <span class="toc-text">Performing Time-Based Operations</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Observing-Time"><span class="toc-number">5.1.</span> <span class="toc-text">Observing Time</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Periodic-Observations"><span class="toc-number">5.1.1.</span> <span class="toc-text">Periodic Observations</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Boundary-Observations"><span class="toc-number">5.1.2.</span> <span class="toc-text">Boundary Observations</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Seeking-Media"><span class="toc-number">5.2.</span> <span class="toc-text">Seeking Media</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">6.</span> <span class="toc-text">Reference</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/&text=AVFoundation 공부"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/&title=AVFoundation 공부"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/&is_video=false&description=AVFoundation 공부"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=AVFoundation 공부&body=Check out this article: https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/&title=AVFoundation 공부"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/&title=AVFoundation 공부"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/&title=AVFoundation 공부"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/&title=AVFoundation 공부"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://wnstkdyu.github.io/2018/05/03/avfoundationprogrammingguide/&name=AVFoundation 공부&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 Alpaca
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Posts</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-116302583-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'alpacablog';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


